# SpringBoot-Kafka-Template

## About

A Spring Boot-based project that has an API application and a Client application that use Kafka for messaging between them.  The idea is that this can be used as a template for new projects having similar needs

Some of the tech used:

- Spring Boot
- Apache Kafka
- Spring Cloud Config


## Install, Setup and Run Kafka (which includes Zookeeper)

1. Download the binary:    **http://kafka.apache.org/downloads.html**

2. Explode the downloaded file and put it in a common dir of your choice, like:    **/usr/local**

3. Create a symlink for it:   **ln -s /usr/local/kafka_2.11-0.10.1.0 /usr/local/kafka**

4. Create KAFKA_HOME environment variable (maybe in .bash_profile): **export KAFKA_HOME=/usr/local/kafka**

5. Start Zookeeper first, specifying where the configuration properties file it requires is:

	$KAFKA_HOME/bin/zookeeper-server-start.sh  $KAFKA_HOME/config/zookeeper.properties

6. Start Kafka (on a different tab?), which too requires a configuration file

	$KAFKA_HOME/bin/kafka-server-start.sh  $KAFKA_HOME/config/server.properties


### Install, Setup and Run the Spring Cloud Config server
1. Clone this repository to somewhere on your system (like:  **~/Desktop/config**):

    git@github.com:henrydall/springboot-kafka-template-config.git

2. Check the contents of the 2 properties files included in that project, making sure that they match the configuration on your system.

3. From the root directory of this project:

    cd config-server
    gradle clean build
    java -jar build/libs/springboot-kafka-template-config-server-0.0.1-SNAPSHOT.jar

4.  To test that it is running, hit this url in your browser:

        http://localhost:8888/config-server/default

    And you should see this, and more:
       
        {
            "name": "config-server",
            "profiles": [
                "default"
            ],
            "label": "master"
        }

## Spring Boot-based API-Server and Kafka-Consumer applications

1. Start up the API application (aka Kafka Producer) from the root of the project:

    cd api
    gradle clean build
    java -jar build/libs/springboot-kafka-template-api-0.0.1-SNAPSHOT.jar

2. Then start up the Kafka-Consumer application from the root of the project:
     
    cd kafka-consumer
    gradle clean build
    java -jar build/libs/springboot-kafka-template-consumer-0.0.1-SNAPSHOT.jar

3.  Now Test that it is all working

    At this point some sample messages can be generated by POSTing a request to this endpoint:

        http://localhost:7070/workunits
    
    with a JSON payload like this:

        {
	        "id": 122,
            "description": "abcdee"
        }

    Or use cURL like this:

        curl -X POST http://localhost:7070/workunits -H "Content-Type: application/json" -d '{ "id": 111, "description": "TEST" }' 

    The console output for the API Server app should print out a message on the console that the Work unit has been dispatched and the Kafka Consumer app should receive and process the Work unit, showing that in its console.




    
